{"code":"!function(e){var t={};function s(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=t,s.d=function(e,t,o){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},s.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var n in e)s.d(o,n,function(t){return e[t]}.bind(null,n));return o},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,\"a\",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p=\"\",s(s.s=0)}([function(e,t,s){\"use strict\";s.r(t);const o={sl:{dom:{errors:\".errors\",psychicsContainer:\".psychicsContainer\",guessesContainer:\".guessesContainer\",preloader:\".preloader\",startButton:\".start\",form:\"#form\"},cl:{uikit:{hidden:\"uk-hidden\"},psychic:\"psychic\",guess:\"guess\"}},dom:{},errors:e=>{if(console.log(e),!o.dom.errors)return;const t=document.createElement(\"div\");o.dom.errors.appendChild(t)},templates:{psychics:e=>{const t=document.createElement(\"div\");return t.classList.add(o.sl.cl.psychic),t.insertAdjacentHTML(\"afterBegin\",['<div class=\"uk-card uk-card-default uk-card-body\">','    <div class=\"uk-card-media-top\">',`        <img src=\"${e.photoPath}\" ${e.photoPath?\"\":o.sl.cl.uikit.hidden}>`,\"    </div>\",'    <div class=\"uk-card-body\">',`        <h3 class=\"uk-card-title\">${e.name}</h3>`,`        <p>Рейтинг: ${e.rating}</p>`,\"    </div>\",\"</div>\"].join(\"\")),t},guesses:e=>{const t=document.createElement(\"div\");return t.classList.add(o.sl.cl.guess),t.insertAdjacentHTML(\"afterBegin\",['<div class=\"uk-card uk-card-default uk-card-body\">',`<h3 class=\"uk-card-title\">${e}</h3>`,\"</div>\"].join(\"\")),t}},state:{begin:()=>{o.dom.startButton.classList.remove(o.sl.cl.uikit.hidden),o.dom.form.classList.add(o.sl.cl.uikit.hidden),o.dom.guessesContainer.classList.add(o.sl.cl.uikit.hidden),o.dom.form.elements.number.value=\"\"},guess:()=>{o.dom.startButton.classList.add(o.sl.cl.uikit.hidden),o.dom.form.classList.remove(o.sl.cl.uikit.hidden),o.dom.guessesContainer.classList.remove(o.sl.cl.uikit.hidden)}},ms:{toGuess:JSON.stringify({step:\"toGuess\"}),toAnswer:e=>JSON.stringify({answer:e}),lostConnection:\"потеряно соединение, перезагрузите страницу\"}};var n=o;const r=(e,t)=>{e.length&&(n.dom[`${t}Container`].textContent=\"\",e.forEach(e=>{const s=n.templates[t](e);n.dom[`${t}Container`].appendChild(s)}))};(()=>new Promise(e=>window.addEventListener(\"load\",()=>e(\"load\"))))().then(()=>new Promise((e,t)=>{Object.keys(n.sl.dom).forEach(e=>{n.dom[e]=document.querySelector(n.sl.dom[e]),n.dom[e]||t(`'${n.sl.dom[e]}' в dom не найден`)}),e()})).then(()=>new Promise((e,t)=>{const s=new WebSocket(\"ws://localhost:81\");s.onerror=e=>{throw console.log(\"WebSocket connection error\"),e},s.onopen=()=>{console.log(\"WebSocket connection established\"),n.dom.preloader.classList.add(n.sl.cl.uikit.hidden),s.send(JSON.stringify({test:\"test\"}))},s.onclose=e=>{e.wasClean?console.log(\"Соединение закрыто чисто\"):console.log(\"Обрыв соединения\"),console.log(\"Код: \"+e.code+\" причина: \"+e.reason),console.log(e),n.errors(n.ms.lostConnection)},s.onmessage=e=>{const t=JSON.parse(e.data);console.log(t);const{psychics:s=[],guesses:o=[],state:i=\"\"}=t;r(s,\"psychics\"),r(o,\"guesses\"),n.state[i]&&n.state[i]()},n.dom.startButton.addEventListener(\"click\",()=>{s.send(n.ms.toGuess)}),n.dom.form.addEventListener(\"submit\",e=>{e.preventDefault(),s.send(n.ms.toAnswer(form.elements.number.value))})})).catch(e=>{console.log(e)})}]);","extractedComments":[]}